<%- include('../partials/header') %>
<div class="container">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a class="text-decoration-none text-info" href="/">Home</a></li>
      <li class="breadcrumb-item text-white active" aria-current="page">Public Package</li>
    </ol>
  </nav>
  <% if(typeof package !== 'undefined') { %>
  <div class="row">
    <h2 class="text-center">Package:</h2>
    <div class="col-12">
      <div class="row package-info border-bottom mb-3">
        <div class="col-3 d-flex justify-content-end">
          <div class="mt-4 pt-1">Version: <%= package.version %></div>
        </div>
        <div class="col-6 text-center package-info-name pt-0">
          <%= package.name %>
        </div>
        <div class="col-3 pt-2 d-flex justify-content-between">
          <div class="mt-3">Updated: <%= package.date.toLocaleDateString(); %></div><a href="<%= package.url %>" class="text-info text-decoration-none fs-2" target="_blank">NPM <i class="bi bi-arrow-right"></i></a>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-10 offset-1">
      <div class="row">
        <div class="col-12">
          <label for="description">Description</label>
          <div id="packageDescriptionCard" class="card bg-dark p-2 mb-3">
            <%= package.description %>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
        <% if(package.repositories.length) { %>
          <h6>Repositories</h6>
          <div class="card bg-dark mb-3">
            <table class="table table-dark table-hover align-self-center mb-0">
              <% for(let i = 0; i < package.repositories.length; i++) { %>
              <tr>
                <td>
                  <a href="<%= package.repositories[i] %>" class="text-info text-decoration-none" target="_blank"><%= package.repositories[i] %></a>
                </td>
              </tr>
              <% } %>
            </table>
          </div>
        <% } %>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <% if(package.snippets.length) { %>
            <h6>Code Snippets</h6>
            <div class="bg-dark card p-0">
            <table class="table table-dark table-hover align-self-center w-100 m-0">
              <% for(let i = 0; i < package.snippets.length; i++) { %>
              <tr>
                <td class="p-0">
                  <div class="p-0">
                    <div class="snippet-version snippet m-2">v<%= package.snippets[i].currentPackageVersion %></div>
                    <pre class="w-100 snippet"><code class="language-js"><%= package.snippets[i].snippet %></code></pre>
                  </div>
                </td>
                <td>
                  <div class="text-end px-3">
                    <a href="/packages/<%= package._id %>/snippets/<%= i %>" class="text-danger text-decoration-none">delete</a>
                  </div>
                </td>
              </tr>
              <% } %>
            </table>
            </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
  <% } else { %>
    <h2 class="text-center mt-5 pt-5">This package is private</h2>
    <h4 class="text-center">Please contact the package owner for access.</h4>

    <% } %>
</div>
<%- include('../partials/footer') %>